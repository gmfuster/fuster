<div class="PaddedContents ">    

<div >

    <br/>
    <h2 class="CenterMe">SQL notes - Basics</h2>      
    <div class="TopLinks" #HeadingsContainer>      
        <top-links ></top-links>      
      </div>  
      <br/>
            
        <p class="HeadingSubTopic" id="Selects" HeadingSubTopicDir>Selects</p>

        <pre>
            SELECT * FROM orders

            SELECT OrderID, OrderDate FROM orders

            SELECT DISTINCT ShipCity FROM orders

            SELECT COUNT(DISTINCT ShipCity) FROM orders;

            SELECT * FROM orders WHERE EmployeeId > 8;

            SELECT * FROM Customers WHERE Country='Germany' AND City='Berlin';

            SELECT * FROM Customers WHERE NOT Country='Germany';

            SELECT * FROM Customers ORDER BY Country DESC;

            SELECT * FROM Customers ORDER BY Country ASC, city DESC;

            SELECT SUM(Freight) FROM orders WHERE EmployeeId = 4

            SELECT CustomerID, CompanyName AS CN FROM Customers

            SELECT EmployeeId, SUM(Freight) FROM orders WHERE EmployeeId > 4
            GROUP BY EmployeeId

            SELECT EmployeeId, AVG(Freight) FROM orders WHERE EmployeeId > 4
            GROUP BY EmployeeId

            SELECT COUNT(*) FROM CUSTOMERS; /*92*/
            SELECT COUNT(Region) FROM CUSTOMERS; /*31*/
            SELECT COUNT(*) FROM CUSTOMERS WHERE Region IS NOT NULL; /*31*/

            SELECT city, Country, COUNT(*) FROM Customers 
            WHERE CompanyName LIKE 'A%' OR Address LIKE 'A%'
            GROUP BY Country, City
            HAVING COUNT(*) > 1

            SELECT TOP 3 * FROM Customers;

            SELECT TOP 50 PERCENT * FROM Customers;

            SELECT MIN(PostalCode) AS smallestPC FROM Customers;

            SELECT * FROM Customers WHERE City LIKE 'L_n_on';

            SELECT * FROM Customers WHERE Country IN ('Germany', 'France', 'UK');

            SELECT * FROM Customers WHERE Country IN (SELECT Country FROM Suppliers);

            SELECT * FROM Employees WHERE EmployeeId BETWEEN 1 AND 5;



        </pre>

        <p class="HeadingSubTopic" id="Inserts" HeadingSubTopicDir>Inserts</p>

        <pre>
            INSERT INTO Customers (CustomerID, CompanyName, ContactName, Address, City, PostalCode, Country)
            VALUES ('CA', 'A', 'Tom B', 'Skagen 21', 'Stavanger', '4006', 'Norway');

            INSERT INTO Customers 
            VALUES ('CAA', 'ACOMP', 'Tom B', 'Sir', 'Skagen 21', 'Stavanger', 'RE', '4006', 'Norway', NULL, NULL);

            INSERT INTO Customers (CustomerID, CompanyName, ContactName, Address, City, PostalCode, Country)
            VALUES 
			('CAAA', 'A', 'Tom B', 'Skagen 21', 'Stavanger', '4006', 'Norway'),
			('CAAAA', 'A', 'Tom B', 'Skagen 21', 'Stavanger', '4006', 'Norway');

            DECLARE @temp Table (
	            CompanyName varchar(200),
	            ContactName varchar(200)
            );

            INSERT INTO @temp
            SELECT CompanyName, ContactName FROM Customers
            
        </pre>  

        <p class="HeadingSubTopic" id="Updates" HeadingSubTopicDir>Updates</p>

        <pre>
            UPDATE Customers SET City = 'MADRID' WHERE city='Madrid'

            UPDATE Customers SET Region = LEFT(City, 2)  WHERE Region IS NULL


        </pre>

        <p class="HeadingSubTopic" id="Delete" HeadingSubTopicDir>Delete</p>

        <pre>
            DELETE FROM Customers WHERE CompanyName='A';

            DELETE FROM Customers;
        </pre>


       <p class="HeadingSubTopic" id="Joins" HeadingSubTopicDir>Joins</p>

       A JOIN clause is used to combine rows from two or more tables, based on a related column between them.

       <p class="HeadingSubTopic2" >Inner Joins</p>

        Records have to match in both tables.

        <pre>
        SELECT Orders.OrderID, Customers.ContactName
        FROM Orders
        INNER JOIN Customers ON Orders.CustomerID=Customers.CustomerID;

        SELECT Orders.OrderID, Orders.CustomerId AS orderCI, customers.CustomerId AS CustID, Orders.ShipVia AS ordershipvia, Shippers.ShipperId,  Shippers.CompanyName
        FROM ( (Orders
	        INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID)
	        INNER JOIN Shippers ON Orders.ShipVia = Shippers.ShipperID);        

        </pre>

        <p class="HeadingSubTopic2" >LEFT OUTER JOIN or LEFT JOIN</p>
        Returns all records from the left table, and the matched records from the right table

        <pre>
        /*just checking what customers don't have any orders.  
        SELECT * FROM Customers WHERE customerId NOT IN (select CustomerId from orders)

        /*the rows that are coming up not having any orders will show up in the left join statement */
        SELECT Customers.CustomerId, Customers.ContactName, Orders.OrderID
        FROM Customers
        LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID
        ORDER BY Customers.CustomerId;

        </pre>

        <p class="HeadingSubTopic2" >RIGHT OUTER JOIN or RIGHT JOIN</p>

        Returns all records from the right table, and the matched records from the left table

        <pre>
        SELECT Orders.OrderID, Employees.LastName, Employees.FirstName
        FROM Orders
        RIGHT JOIN Employees ON Orders.EmployeeID = Employees.EmployeeID
        ORDER BY Orders.OrderID;        
        </pre>
        <p class="HeadingSubTopic2" >FULL OUTER JOIN or FULL JOIN</p>

        Returns all records when there is a match in either left or right table

        <pre>
        SELECT Customers.CompanyName, Orders.OrderID
        FROM Customers
        FULL OUTER JOIN Orders ON Customers.CustomerID=Orders.CustomerID
        ORDER BY Customers.CompanyName;
        </pre>

        <p class="HeadingSubTopic2" >SELF JOIN</p>

        <pre>
        SELECT A.CompanyName AS CustomerName1, B.CompanyName AS CustomerName2, A.City
        FROM Customers A, Customers B
        WHERE A.CustomerID &lt;&gt; B.CustomerID
        AND A.City = B.City
        ORDER BY A.City;
        </pre>

        <p class="HeadingSubTopic2" >CROSS JOIN</p>

        It joins every record on one side with every record on the other side.  Very large results.

        <pre>
        SELECT * FROM Customers /*92 records*/
        SELECT * FROM Orders /*830 records */ 

        SELECT Customers.CompanyName, Orders.OrderID /* 76360 records = 92 * 830 */
        FROM Customers
        CROSS JOIN Orders;
        </pre>

        <p class="HeadingSubTopic2" >UNIONS</p>

        <pre>
        SELECT City FROM Customers /* returns distinct values */
        UNION
        SELECT City FROM Suppliers
        ORDER BY City;

        SELECT City FROM Customers /* with duplicates */ 
        UNION ALL
        SELECT City FROM Suppliers
        ORDER BY City;
        </pre>

        <p class="HeadingSubTopic" id="Create" HeadingSubTopicDir>CREATE</p>
        <pre>
        CREATE TABLE [dbo].[Categories](
	    [CategoryId] [int] IDENTITY(1,1) NOT NULL,
	    [CategoryName] [nvarchar](15) NOT NULL,
	    [Description] [ntext] NULL,
	    [Picture] [image] NULL,
         CONSTRAINT [PK_Categories] PRIMARY KEY CLUSTERED 
        (
	        [CategoryId] ASC
        )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
        ) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
        </pre>


        <p class="HeadingSubTopic" id="Alter" HeadingSubTopicDir>ALTER</p>
        <pre>
        ALTER TABLE Customers
            ADD Email varchar(255);

        ALTER TABLE Customers
            DROP COLUMN Email;

        ALTER TABLE Persons
            ALTER COLUMN DateOfBirth year; /*change the type*/
        </pre>


    </div>
</div>